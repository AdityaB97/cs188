{"start":[0,1670,4520,6460,9090,12230,15330,18770,23260,24460,26850,28560,34780,36420,38430,39760,42820,45450,47140,50280,50980,55170,57530,60400,62510,63460,64900,68110,71140,72350,75640,80570,81280,84340,85530,89970,91460,95490,97630,99060,102450,104770,105720,110300,111680,112650,114750,117310,120130,123030,126900,129910,132400,135680,138610,141540,145710,147640,149350,151120,153160,157420,159040,161850,163670,167060,170570,173990,175200,176480,179260,180590,183910,187760,190790,193310,196120,200030,201970,205540,208580,212200,214090,216730,218540,220220,223700,224500,226740,229630,233210,237630,239560,241850,243980,245220,247460,251670,253640,256589,260860,263010,266790,271790,274160,276640,279700,281600,285810,289860,291720,295430,298230,301470,303850,305690,311620,314180,316690,319620,321620,325470,327460,331340,334020,336950,339130,343410,347330,350490,352540,356620,360590,361840,365210,368810,370180,371710,373220,374530,376340,378740,384010,387610,391390,393760,397570,399740,403910,408490,411880,413780,416770,418450,422290,423975,428700,429400,432220,433760,438590,441020,443970,445550,449230,452200,454330,455930,460870,463050,465760,468790,470430,475140,479360,481980,483710,487770],"end":[1670,4520,6460,9090,12230,15330,18770,23260,24460,26850,28560,34780,36420,38430,39760,42820,45450,47140,50280,50980,55170,57530,60400,62510,63460,64900,68110,71140,72350,75640,80570,81280,84340,85530,89970,91460,95490,97630,99060,102450,104770,105720,110300,111680,112650,114750,117310,120130,123030,126900,129910,132400,135680,138610,141540,145710,147640,149350,151120,153160,157420,159040,161850,163670,167060,170570,173990,175200,176480,179260,180590,183910,187760,190790,193310,196120,200030,201970,205540,208580,212200,214090,216730,218540,220220,223700,224500,226740,229630,233210,237630,239560,241850,243980,245220,247460,251670,253640,256589,260860,263010,266790,271790,274160,276640,279700,281600,285810,289860,291720,295430,298230,301470,303850,305690,311620,314180,316690,319620,321620,325470,327460,331340,334020,336950,339130,343410,347330,350490,352540,356620,360590,361840,365210,368810,370180,371710,373220,374530,376340,378740,384010,387610,391390,393760,397570,399740,403910,408490,411880,413780,416770,418450,422290,423975,428700,429400,432220,433760,438590,441020,443970,445550,449230,452200,454330,455930,460870,463050,465760,468790,470430,475140,479360,481980,483710,487770,489333],"text":["","DAN KLEIN: Now let's talk about enforcing arc consistency for an","entire CSP.","Well, this is going to be a simple form of propagation.","And what we're going to do is we're going to make sure all of the arcs are","consistent all at once.","And when that's done, we will have done a more aggressive job than","forward checking of pruning down the remaining domains, and hopefully saved","ourselves some work.","So the idea is we're always going to delete from the tail.","Now let's look at this configuration.","Q is green, WA is red, and we know that NT and SA can't both be blue in","terms of actually getting a solution.","Forward checking left us here.","It looks like everything's OK.","We'll eventually in a backtracking search discover were wrong, but let's","see if we can figure out an algorithm which will detect the","failure right away.","Well, in order to enforce arc consistency, the algorithm's actually","pretty simple.","We're going to visit every single arc, check if it's consistent, and if not,","we're going to delete stuff from the tail.","Hopefully, this whole process will converge and we'll end up with","something that's consistent everywhere.","So what can we do?","Well, we can look over here.","We can say New South Wales and Victoria.","We could look at them and say, is this arc consistent?","Well let's think about it.","We have to check everything in the trunk, that's Victoria.","Is there any value in the trunk which guarantees us failure?","Here?","No, because if I pick red in the trunk, I can pick blue","at New South Wales.","If I pick blue at Victoria, then I can pick red at New South Wales.","And so there's no problem.","This constraint, it receives the stamp of consistency.","All right, so this arc is consistent.","Now we can check this arc.","So we look at Southern Australia and New South Wales.","They're adjacent, s they can't be the same color.","And so we look.","And Southern Australia, if we assign blue, will it work out?","Yes.","OK, it's consistent.","So, so far, we haven't had to do anything.","But let's say we look at the arc in this direction.","Well now we're looking at New South Wales and we're asking, are there any","values here at the tail that will doom us on this arc?","The answer now is, yes, we better not pick blue because if we do, there's no","way to assign at SA without violating a constraint.","So, we delete it.","","Now, of course, we can continue doing this for arc after arc after arc.","But the interesting thing is, let's go back to that arc we just did.","We just declared this arc here to be consistent.","Is it still consistent?","No, it just stopped being consistent.","And it stopped being consistent because something","disappeared from its head.","And so when blue went out of its head, now suddenly red is no","longer OK in the tail.","And so in order to make this arc consistent again, we","need to do some deleting.","This is basically the algorithm for enforcing arc consistency.","The important thing to remember is that we're going to visit all of the","arcs over and over and over again until everybody is simultaneously","consistent.","Why this is a good idea?","Well, it prunes things down a lot more than forward checking.","It also can detect failure.","So for example, in the version shown here, if we check the arc from","Southern Australia to the Northern Territory, we would delete blue from","Southern Australia and then we would see an empty domain and we'd fail.","So in fact, it will solve our original case.","When we check these arcs over and over, the reason we have to check them","more than once is because whenever a variable loses a value, all of the","incoming arcs need to be rechecked.","So we're going to have to check things multiple times.","What's the role of this thing in the backtracking search?","You make an assignment, you enforce the consistency of a whole bunch of","arcs, it may take awhile.","Then you make another assignment, and then you enforce the consistency of a","whole bunch of stuff, it may take a while.","And you go on recursing.","It makes each step slower, but hopefully you'll have to do less","backtracking.","And this should remind you of something from search.","What's this remind you of from search?","This should remind you of A* from search, where computing the heuristic","cost time, but hopefully reduced the amount of actual search tree action","you had to do.","All right, so, what's the algorithm look like?","I'm not going to walk through the entire pseudocode because we've","already pretty much covered it.","But it's in the slides here for you.","The important bits are there is going to be a queue, which initially is all","of the arcs in the CSP.","And as long as there's stuff in the queue, we're going to take something","off the queue, we're going to make that arc consistent by removing values","from its tail as needed.","If anything was actually removed, stuff may go back on the queue.","Because any time a variable's domain shrinks, all of its neighbors pointing","to it have to go back on to the queue.","And then we'd run this until the queue becomes empty.","So you have some worries, like maybe we'll just run this forever.","Can this run forever?","This can't run forever, because every time an arc goes on the queue, it went","on the queue because its head's domain shrank.","That can only happen so many times.","In particular, for a given arc it can only happen d many times.","How long does it take to remove the inconsistent values?","Well you have to check everything in the head, everything in the tail, and","then do a function call to your constraint, which, let's say, takes","constant time.","OK, so removing the inconsistent values is going to cost d squared.","There are n squared arcs to begin with.","And each one may have to processed d times.","So this whole thing, if you kind of calculate it in a naive way, it works","out to be n squared d cubed.","And you can shave off a factor of d if you're clever.","However, that's polynomial.","We know that CSPs are NP-hard, and that means that detecting all possible","future problems isn't going to work.","Let's see this algorithm running.","Let's go back to my wonderful illustration of the five queens","problem and the AI space applet.","Right now, looking at this, it is in fact consistent.","So I could tell this applet to make this arc consistent.","And if I did that, what would it do?","It would visit every arc, turning it from blue, meaning it's on the queue,","to green, meaning it is guaranteed consistent.","And it'll check each one.","But basically, there's nothing to do at the beginning.","It's very common, though not always true, that the initial CSP will","already be arc consistent.","Sometimes it's not.","All right, so now it's arc consistent.","Let me reset that.","What would happen in the backtracking search?","We'd assign something.","So we go here and would keep, let's say, just the value 1.","That's equivalent to putting the queen in the corner.","So now the domain of A shrinks.","Let's run arc consistency here.","So once we shrink the domain of A, we can enforce arc consistency using the","AC-3 algorithm.","And I'll do a little bit of it manually here, so I can check this arc","going from A to B. And it was already consistent.","But the arc and the other direction, think about B here.","I just put a queen up here.","","So B can't be 1 or 2.","And so when I enforce this, some things will disappear from the domain.","I'm going to do the rest automatically.","And what you'll see is mostly we go along making things consistent and","turning them green.","Every now and then we'll delete some values from a domain.","There'll be a flash of red.","And the flash of red is something that was once consistent becoming no longer","guaranteed consistent and going back on the queue.","","And this is actually a good effect.","As things go from consistent or inconsistent, and then we process them","again, and something else goes from consistent to inconsistent, we're","essentially chasing down the consequences of our","constraints across the graph.","And now we can see that everything is consistent and we could then continue","with the backtracking search.","But I won't show all of that.","What about arc consistency when we have constraints that involve more","than two variables?","At the moment, this algorithm is only defined as I've given it to you for","binary CSPs, meaning they are at most two variables per constraint.","There are analogs of this for higher order constraints and there are","variations of this algorithm.","This one, as it's stated here, will only work for binary CSPs.",""]}