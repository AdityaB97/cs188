{"start":[0,1490,4120,8420,9250,11070,14200,15640,17820,20470,24370,28110,31400,33420,35040,38500,41110,44170,45260,49020,50860,53420,57700,61130,65319,70160,73820,77250,79810,82140,85000,89040,90950,92030,96620,98680,100030,103190,106300,107640,110730,111490,114950,116240,117950,124870,127710,129410,131870,136010,138670,140050,141670,144340,145410,148180,149360,153640,156090,158500,161280,164950,168540,171970,176540,178620,182170,183370,186320,188990,191390,194000,195642,200060,203590,205190,208800,213230,217070,220620,222650,225620,228060,234690,235810,238960,240715,243650,247310,250080,253840,255860,259769,262600,264430,266110,269360,272640,275980,277700,281310,283820,285070,289140,293600,296530,298150,299440,301420,302840,304800,308090,309510,313070,316240,320900,325710,328200,329310,330760,335220,336570,339840,342040,343860,345830,346670,348880,351410,355040,357770,360720,364710,367620,370870,373970,376270,381760,383130,386860,394240,396070,399090,403770,405220,406660,408900,410140,411260,413110,414190,415540,417670,421700,423780,427370,430480,434080,436230,440390,445860,449060,452370,455800,460380,464920,467880,468730,470470,473130,475430,476910,478880,480640,481950,482750,485290,486350,487980,489610,493870,497710,501800,505230,508700,512460,514570,517309,520460,522450,527310,529990,533380,534830,537440,538490,539400,541450,544020,547020,551790,554720,558165,559470,561980,564830,567880,573280,574080,577640,579570,583156,586320,587940,589890,591710,595790,597280,598910,600630,601790,604020,607000,609450,613400,615966,618110,620750,624620,626490,630200,635030,637070,641770,644770,645730,648870,652540,654940,656440,660260,661860,663100,665960,666490,669020,672780,676130,678220,680300,681740,684210,685620],"end":[1490,4120,8420,9250,11070,14200,15640,17820,20470,24370,28110,31400,33420,35040,38500,41110,44170,45260,49020,50860,53420,57700,61130,65319,70160,73820,77250,79810,82140,85000,89040,90950,92030,96620,98680,100030,103190,106300,107640,110730,111490,114950,116240,117950,124870,127710,129410,131870,136010,138670,140050,141670,144340,145410,148180,149360,153640,156090,158500,161280,164950,168540,171970,176540,178620,182170,183370,186320,188990,191390,194000,195642,200060,203590,205190,208800,213230,217070,220620,222650,225620,228060,234690,235810,238960,240715,243650,247310,250080,253840,255860,259769,262600,264430,266110,269360,272640,275980,277700,281310,283820,285070,289140,293600,296530,298150,299440,301420,302840,304800,308090,309510,313070,316240,320900,325710,328200,329310,330760,335220,336570,339840,342040,343860,345830,346670,348880,351410,355040,357770,360720,364710,367620,370870,373970,376270,381760,383130,386860,394240,396070,399090,403770,405220,406660,408900,410140,411260,413110,414190,415540,417670,421700,423780,427370,430480,434080,436230,440390,445860,449060,452370,455800,460380,464920,467880,468730,470470,473130,475430,476910,478880,480640,481950,482750,485290,486350,487980,489610,493870,497710,501800,505230,508700,512460,514570,517309,520460,522450,527310,529990,533380,534830,537440,538490,539400,541450,544020,547020,551790,554720,558165,559470,561980,564830,567880,573280,574080,577640,579570,583156,586320,587940,589890,591710,595790,597280,598910,600630,601790,604020,607000,609450,613400,615966,618110,620750,624620,626490,630200,635030,637070,641770,644770,645730,648870,652540,654940,656440,660260,661860,663100,665960,666490,669020,672780,676130,678220,680300,681740,684210,685620,686870],"text":["","DAN KLEIN: So before we figure out how to do search in the presence of","actions, whose outcomes are uncertain, we should think why would we ever be","in this situation?","Is this just some weird thing that happens?","Well, there's a lot of reasons why you could have uncertainty as to the","outcome of your action.","Sometimes there is explicit randomness.","And in the case of games, this is often intentionally there.","For example, you may actually roll some dice while playing a game.","That's a case where you are explicitly taking an action kind of for the whole","purpose of injecting randomness into the process.","But that's not really everything.","Sometimes your opponents are unpredictable.","For example, there might be some randomness into how a ghost respond.","But in the real world, it's even more than that.","It's the fact that when you take an action, you're never really sure","what's going to happen.","For example, if you're doing robot motion and you tell the robot to move","its wheel, well, it might move forward.","Or the wheels might slip or they might jam.","And in general, any action you take will have some uncertainty in the real","world as to what exactly will happen.","In the case where your outcomes are not worst case, they're just","controlled by some element of chance that you can't predict, the values we","assign to various states should take that into account.","And the values now should reflect an average case rather than","a worst case scenario.","The worst case-- that's minimax reasoning.","And today we're going to talk about expectimax reasoning, where","essentially we replace all of the mins with averages.","So let's look at this tree over here.","What happens on the left?","Well, the value of this left node should clearly be 10 regardless of the","outcome, because both outcomes are 10.","How about on the right?","How much should we value this node on the right?","Well, in minimax, it's only worth 9, because that's what your opponent's","going to force.","But now it should probably be bigger than 9, because we might get that 100.","How much bigger?","Well, it's going to depend on how likely it is the 9 versus the 100","outcome is.","Let's say they're equally likely.","If they're are equally likely, then it's going to be 54.5.","And then we should probably take the right node, at least if they're","equally likely.","This is the basic idea of expectimax search.","What we're going to compute in an expectimax search is not the best","score under adversarial play like minimax.","It's not a minimax value.","It's an expectimax value.","And that's the average score under optimal play.","Why is it an average?","Because no matter how well you play, who knows what's going to happen when","the dice roll?","So what we need to compute is whatever actions are going to give me the best","outcome on average.","Max nodes are just like a minimax search.","Chances are just like min nodes in the sense that they're out of your","control, but rather than worst case we're going to assume average case.","What we will be calculating here is expected utilities.","If you think about the numbers at the bottom of the tree as utilities for","the agent, and now we're taking averages or expectations, this is this","idea of an expected utility.","You don't know how good this state is, but you can talk about its average","utility to you.","And that's something if you remember way back to the first lecture, and the","maximum expected utility principle, we're finally getting","to be able to unpack.","All right, let's take a look at why this is important again","in the Pac-Man demo.","And let's remember what happens in this scenario here.","This scenario is, in fact, a very simple game tree, because the agents","are so constrained.","And in a minimax scenario, Pac-Man sees two options--","dive bomb the ghost or make a try for the dots.","If the ghosts are adversarial, then you should dive bomb the close ghost.","Because the game's going to end either way, and in this variant of Pac-Man,","you would lose a point every turn.","And so, in fact, in the minimax case, you dive bomb the ghost.","And, in fact, the game ends.","But we also realized that if those ghosts were in fact random, o orange","ghost doesn't have a choice.","The only real choice is what b;ue ghost is going to do.","So now Pac-Man should think average case.","Pac-Man should think well, the difference between going left and","right in the case that the blue ghost moves up is not that great.","It's one point plus or minus, right?","But if the blue ghost happens to move down, we can win the game and get a","huge bonus at the end.","And so in this case, even if we're unsuccessful, even if in fact we are","not lucky, the action we should take now to maximize our","utility is to go left.","So we're going to go left.","And well, it didn't work out.","So just because you were rational, just because you did the action which","maximizes your expected utility, does not mean you'll be successful.","You can still be unlucky.","But if we try this a bunch of times--","oh, please, random number generator--","it'll work out.","","All right, so that's the case for expectimax reasoning.","The expectimax pseudo code is about what you would think.","We have a notion of a value of the state.","It's no longer a minimax value.","It's now an expectimax value.","And how do we compute that value?","Well, we're going to do it recursively.","If that state is terminal, then it's marked with its utility and we just","return that.","If it's a Max state, meaning in the next action is under the control of","the agent, then we max over the children.","If the next agent is the expectation, meaning this is the role of a die or","an uncertain opponent, then we should take some kind of average.","Max looks just like it did before.","We started at negative infinity.","We look at all of the successors.","And one by one, we take a maximum as we go.","What's new here is on the right.","How do we compute the average value of a state?","So let's zoom in on that.","Well we have some state.","And we're going to take an average of its children.","So how do we do that?","We loop over all the children.","For each child, we compute its value.","And we figure out the chance of that child will happen from here.","And so far we've been acting like all children are equal, but that's not","always going to be true in every expectimax search.","So for each child, we compute a probability and we compute a value.","We take the products, and we add them up.","So, for example, here, we might be in the state.","We're computing the expectation of the children.","And so what we do is we visit the children one by one.","And the first child has value eight, but is 50 percent likely to occur.","Multiply those together--","1/3 times 24, 1/6 times negative 12.","And we get 10 there's the computation for you.","So let's do an example of this.","So if we imagine all the children are equally likely, we visit the first","child, and we see OK 3, OK 12, OK, 9.","We compute our average.","And we get what?","We get eight.","We go to the silent child child.","We see two, four, and six.","We compute the average.","We get four.","And we visit the last child--","we compute the average and we get seven.","So looking down, yes, we'd like the 15, no, we wouldn't like the 0.","But we don't actually have access to these directly.","We only get to choose amongst these uncertain outcomes whose average","scores are listed here, and so what we should do is we should take this","action and on average get eight","Now for minimax, we were able to be pretty clever.","We were able to do the search, but often we're able to just avoid doing","work by noticing that we had already found a value so good or so bad that","the rest of the children didn't even need to be explored.","Let's see whether or not we can recreate this idea for expectimax.","So let's imagine we've looked at all of the values under the left child,","and we've seen that it has value 8, and we've returned that.","Well, now max has an option of expected value 8.","We go into the second child here in the middle, and we look","at its first child.","And we see a 2.","So far, the state looks pretty bad.","maximum would not pick a 2.","But there are still children to check.","Now minimax, we were done.","Because it might get lower than 2, but it certainly wasn't","going to get higher.","This is an average.","Can this get higher than 2?","Absolutely.","How much higher?","Arbitrarily high.","So unless we actually have some kind of bound on the range of these values,","we have to keep going, because even if there's only one child left, and this","node looks terrible, that last child could be a million dollars.","If you have bounds, that does change.","So in general, with expectimax, it's just a lot harder to prune.","And the reason it's hard to prune is because the values of a state--","it's kind of all of the children tangled up.","You can no longer isolate individual children and use them to bound the","rest very easily.","How do you use this in practice?","Well, it's a big game tree, so just like in the minimax case, you can't","really search all the way to the bottom.","This particular expectimax tree is a little more complicated than the","alternating layers we've seen--","so that the agent-- in this case, it's just shown as Pac-Man-- is","moving at the root.","And then the ghosts move.","And let's imagine they are actually random shorts.","They picked randomly amongst their legal actions.","In that case, we would actually have two layers corresponding to the","sequence of two random ghost actions, before Pac-Man moves again.","At the actual end of the game, we know what the states are worth.","This is a game that's defined by its score so you would just look at the","score of those states.","In any case, we're not going to be able to go all the way down to the end","of the game, so at some point we have to cut this off.","When we cut this process offered at some limited depth, we don't actually","know what you will achieve on average from that state under optimal play.","We like that.","We'd like to have some estimate of that value instead, the true value but","true valley would take a lot of work to compute, so we're going to plug-in","our best guess, just like we did with minimax.","It's a little bit harder than it was in minimax to get that process right.","And why is that?","Well let's think about minimax again for a second.","And let's think about worst case reasoning.","And let's think about the minimax tree shown on the left here.","Minimax, this is pretty straightforward.","We look at this tree and we say all right.","On the left I get 0.","On the right, I get 20.","So I should go to the right.","What would happen if we got those numbers wrong?","What would happen if we squared them?","Well, on the left, I would get 0, and on the right I get 400.","So I should go right.","So nothing really changed.","minimax is really about the ordering of the states.","As long as you get your numbers wrong but you preserve that ordering,","minimax will be fine.","Expectimax is a little more fragile, because of how these averages work.","So in particular, let's imagine these are now average case expectimax trees,","and let's think again what happens.","Well, over on the left, the left branch gives me 20, if the children","are even, and 25 over here.","What would I do?","I'd go right and get that 25.","How about in the left version where all I've done is square the values?","I haven't changed their ordering?","What about the left?","Numbers are bigger, so it's 800.","And how about on the other side?","What are we going to get there?","That's 650.","What should we do?","We should go left.","So in this case, squaring these things changed the answer.","Expectimax is much more dependent on the scale and the","shape of these utilities.","And so it's something we're going to have to get right if we want the","results to be meaningful.","The magnitudes are important, not just their order.","And we're going to come back to that later today.",""]}